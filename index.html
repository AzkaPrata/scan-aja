<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Izin Yuk!</title>
        <script src="https://cdn.tailwindcss.com"></script>
        
</head>
<body>
    <script src="./function.js"></script>
    <form id="izin" method="post" action="https://script.google.com/macros/s/AKfycbxzrUgFZXN41RqfPCemVxzw4rM6d475zQuECVhzj6MXL4hKHYOuCsTjuug0FnlmgpOX/exec">
        <div class="form w-1/2 sm:w-full mx-auto border border-slate-100 mt-5 grid content-center rounded-md shadow-md pb-32">
            <h1 class="text-3xl border-b-2 shadow-b-md pb-2 w-11/12 border-slate-200 mx-auto text-center mt-5 mb-2 font-bold">IZIN YUK!</h1>
            <div class="text-center mt-2 mt-2">
                <div id="reader" class="w-1/2 mx-auto rounded-md shadow-inner"></div>
                <div class=" ml-14 text-left text- mb-1 mt-5">Nama Santri  </div>
                <textarea class="border w-10/12 border-slate-300 text-center p-2 rounded-md" name="nama" id="nama" cols="30" rows="1"></textarea>
            </div>
            <div class="text-center mt-2 ">
                <div class=" ml-14 text-left text- mb-1">Kelas  </div>
                <input class="border w-10/12 border-slate-300 text-center p-2 rounded-md" type="text" name="kelas" id="">
    
            </div>
            <div class="text-center mt-2 ">
                <div class=" ml-14 text-left text- mb-1">Keperluan  </div>
                <input class="border w-10/12 border-slate-300 text-center p-2 rounded-md" type="text" name="keperluan" id="">
    
            </div>
            <div class="text-center mt-2 ">
                <div class=" ml-14 text-left text- mb-1">Izin Pada  </div>
                <textarea class="border w-10/12 border-slate-300 text-center p-2 rounded-md date" name="date" id="date" cols="30" rows="1"></textarea>
            </div>
            <div class="text-center mt-2 ">
                <div class=" ml-14 text-left text- mb-1">Tiba Pada  </div>
                <input class="border w-10/12 border-slate-300 text-center p-2 rounded-md" type="text" name="pulang" id="">
    
            </div>
            <div class=" button mt-8 w-full mx-auto flex align-center">
                <button type="submit" class="w-1/4 p-4 border mx-auto border-slate-200 hover:bg-blue-500 hover:text-white transition duration-1000 rounded-md shadow-md">Kirim</button>
            </div>
        </div>
    </form>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>

        const submit = document.querySelector('.button')
        const script = "https://script.google.com/macros/s/AKfycbzS_mfH3HsUtLEqwZdAhP8FQxduR88zrO4wvr3gdqFUrnjS0B8VleNpLZRt5MFegEf3/exec"
        const scanner = new Html5Qrcode('reader')
        const ld = document.querySelector('.loading')
        const config = {fps:10,qrbox:{width:100, height:100}} 
            const qrCodeSuccessCallback = function (decodedText, decodedResult){
            if(decodedText){
            document.getElementById('nama').textContent = decodedText;
            scanner.stop()
            }}
        scanner.start({facingMode:"environment"}, config, qrCodeSuccessCallback)

        const form = document.getElementById('izin');
        form.addEventListener("submit", function(e) {
            e.preventDefault();
            const data = new FormData(form);
            const action = e.target.action;
            fetch('https://script.google.com/macros/s/AKfycbzS_mfH3HsUtLEqwZdAhP8FQxduR88zrO4wvr3gdqFUrnjS0B8VleNpLZRt5MFegEf3/exec', {
                method: 'POST',
                body: data,
                mode:"no-cors"
            })
        .then(() => {
            Swal.fire({
  icon: "success",
  title: "Santri Telah Tercatat",
  confirmButtonText: "Tambah Santri",
  footer: '<a class="text-blue-900 hover:text-blue-300" href="#">Lihat Catatan</a>'
});
            console.log("Success!");
            document.getElementById('nama').textContent = ''
            form.reset()
            scanner.start({facingMode:"environment"}, config, qrCodeSuccessCallback)
        })
  });

    </script>

</body>
</html>
